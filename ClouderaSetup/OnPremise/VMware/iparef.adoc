= FreeIPA Reference

https://www.devopszones.com/2020/03/how-to-add-freeipa-user-in-cli-and-web.html

== Add Users on FreeIPA

Log in to the IPA server and run `kinit` with admin and enter the password:

[source,shell]
kinit admin

Run the below command to create a user. Enter the password in the password prompt.

[source,shell]
ipa user-add --password <User Name>

.Example:
[source,shell]
----
[root@pvcbasemaster ~]# ipa
ipa: ERROR: Ticket expired
[root@pvcbasemaster ~]# kinit admin && klist -e
Password for admin@CLDRSETUP.LOCAL:
[root@pvcbasemaster ~]# ipa user-add --password kdsahu
First name: Kuldeep
Last name: Sahu
User login [kdsahu]: kdsahu
Password:
Enter Password again to verify:
-------------------
Added user "kdsahu"
-------------------
  User login: kdsahu
  First name: Kuldeep
  Last name: Sahu
  Full name: Kuldeep Sahu
  Display name: Kuldeep Sahu
  Initials: KS
  Home directory: /home/kdsahu
  GECOS: Kuldeep Sahu
  Login shell: /bin/sh
  Principal name: kdsahu@CLDRSETUP.LOCAL
  Principal alias: kdsahu@CLDRSETUP.LOCAL
  User password expiration: 20240321113054Z
  Email address: kdsahu@cldrsetup.local
  UID: 971200008
  GID: 971200008
  Password: True
  Member of groups: ipausers
  Kerberos keys available: True
[root@pvcbasemaster ~]# su - kdsahu
Last login: Thu Mar 21 01:00:40 PDT 2024 on pts/0
----

== FreeIPA Command Reference

[source,shell]
----
kinit admin
ipa dnsrecord-add 16.172.in-addr.arpa. 231.31 --ptr-rec console-cdp.apps.pvcecsmaster.cldrsetup.local.
ipa dnsrecord-del 16.172.in-addr.arpa. 231.31 --ptr-rec console-cdp.apps.pvcecsmaster.cldrsetup.local
ipa dnsrecord-find 16.172.in-addr.arpa.
ipa dnsrecord-add cldrsetup.local *.apps
ipa dnszone-list
ipa user-del cmadmin
ipa user-show
ipa status | start | stop
ipactl status | stop | start | restart
----

.Example Password Change
[source,shell]
----
[kuldeep@pvcbasemaster ~]$ kinit kdsahu
Password for kdsahu@CLDRSETUP.LOCAL:
Password expired.  You must change it now.
Enter new password:
Enter it again:
[kuldeep@pvcbasemaster ~]$
----

== LDAP Search Example

[source,shell]
----
[root@ipaserver ~]# ldapsearch  -H ldap://ipaserver.cldrsetup.local:389 -D "uid=admin,cn=users,cn=accounts,dc=cldrsetup,dc=local" -w 'vmware123' -b "cn=users,cn=accounts,dc=cldrsetup,dc=local" '(&(uid=admin))' | grep -v "#"

dn: uid=admin,cn=users,cn=accounts,dc=cldrsetup,dc=local
objectClass: top
objectClass: person
objectClass: posixaccount
objectClass: krbprincipalaux
objectClass: krbticketpolicyaux
objectClass: inetuser
objectClass: ipaobject
objectClass: ipasshuser
objectClass: ipaSshGroupOfPubKeys
uid: admin
krbPrincipalName: admin@CLDRSETUP.LOCAL
cn: Administrator
sn: Administrator
uidNumber: 971200000
gidNumber: 971200000
homeDirectory: /home/admin
loginShell: /bin/bash
gecos: Administrator
ipaUniqueID: e42d6b54-e094-11ee-9c71-0050568db389
memberOf: cn=admins,cn=groups,cn=accounts,dc=cldrsetup,dc=local
krbLastPwdChange: 20240312172405Z
krbPasswordExpiration: 20240610172405Z
krbLoginFailedCount: 0
krbLastFailedAuth: 20240325064805Z

search: 2
result: 0 Success
[root@ipaserver ~]#
----

== DNS Records Lookup

[source,shell]
----
[root@pvcecsmaster ~]# ipa dnsrecord-find 16.172.in-addr.arpa.
  Record name: @
  NS record: ipaserver.cldrsetup.local.
  Record name: 226.31
  PTR record: ipaserver.cldrsetup.local.
  Record name: 227.31
  PTR record: pvcbase-master.cldrsetup.local.
  Record name: 228.31
  PTR record: pvcbase-worker1.cldrsetup.local.
  Record name: 231.31
  PTR record: pvcecs-master.cldrsetup.local.
  Record name: 232.31
  PTR record: pvcecs-worker1.cldrsetup.local.
-----------------------------
Number of entries returned 12
-----------------------------
----

